h1. rah_runtime

p. Rah_runtime returns runtimes from point A to B in microseconds. The plugin can be used to diagnose runtimes of specific blocks of Textpattern's markup code.

h2. Requirements

* Textpattern 4.x.x+

h2. Installation and usage

p. The general behavior stands:

# Go to your Textpattern installation's admin panel.
# Navigate to Admin / Plugins.
# Download and open the plugin code.
# Copy the plugin code to the install plugin box.
# Click install and go thru the automated installation process.
# After installation find the plugin from the plugin list and click Activate.
# Now the plugin is installed and ready to be used.

h2. Tag and attributes

bc. <txp:rah_runtime format="1" index="0" />

p. The plugin introduces a new Textpattern tag, @<txp:rah_runtime />@. The tag calculates a execution runtime for given template markup from point A to point B. The runtimes can be printed to the page template and are added to a page's "tag trace":http://textpattern.net/wiki/index.php?title=Tag_trace.

p. The rah_runtime tag can be used both as a container and as a self-closing single tag. When the tag is used as a container, it calculates the runtime of the wrapped code, ignoring tag attributes as index and persistent. When used as a self-closing single tag, calculates a runtime from the first tag instance to the second.

p. *return*
If set to @1@, the tag outputs the runtime to the page template. If @0@ the runtime is only added and visible in the page's "tag trace":http://textpattern.net/wiki/index.php?title=Tag_trace when the site is in debugging mode. By default @return@ is @0@, and the runtimes are only added to the tag trace.
Example: @return="1"@ Default: @"0"@

p. *index*
With this attribute you can nest several tag pairs and count several independent runtimes.
Example: @index="1"@ Default: @"0"@

p. *format*
Return formatted version of the time. When used, resulting value (float) is presented as a fixed decimal number. By default the option is used (@1@).
Example: @format="0"@ Default: @"1"@

p. *persistent*
If set to @1@, the runtime is kept alive after returning. Normally the runtime pair is destroyed after using it, but with @persistent@ the initial runtime is kept and still usable. The attribute is useful if you want to calculate multiple runtimes from same single starting point.
Example: @persistent="1"@ Default: @"0"@

h2. Examples

h3. Using as a container

bc. <txp:rah_runtime>
	<txp:article_custom />
</txp:rah_runtime>

p. It will return the wrapped markup's results, as it would without the rah_runtime, and the runtime for the wrapped code is added to the tag trace. The page's tag trace should display a line similar to this:

bc. [rah_runtime (0): 0.000010013580322]

h3. Using as a single tag

bc. <txp:rah_runtime />
	<!--
		Some code here, for example:
		<txp:article />
	-->
Runtime: <txp:rah_runtime return="1" />

p. Returns: @[...] Runtime: 0.000011@

h3. Using multiple nested tag pairs

bc. <txp:rah_runtime index="2" />
<txp:rah_runtime index="1" />
Time1: <txp:rah_runtime index="1" />
Time2: <txp:rah_runtime index="2" />

p. Returns: @Time1: 0.000081 Time2: 0.000184@

h3. Using persistent runtimes

p. Persistent runtimes are useful when several runtimes will need to calculated from a same starting point.

bc.. <!--
	Starting the runtime timer
-->

<txp:rah_runtime persistent="1" />


<!--
	Some code here, for example <txp:article /> ...
	then output a (first) runtime
-->

<txp:rah_runtime persistent="1" />

<!--
	Some more code here, for example
	<txp:output_form form="myform" />

	Output runtime, calculated
	from the same original starting point
-->

<txp:rah_runtime persistent="1" />

<!--
	Even some more code.
	Finally, return the final runtime still calculated 
	from the same original starting point.
-->

<txp:rah_runtime />

p. Note that every one of the rah_runtime tags (except for the last) has @persistent@ attribute set to @1@. If the tag doesn't have it, then the runtime pair is destroyed after returning it. To finally destroy the runtime, set persistent to @"0"@ (zero) or leave it undefined.

h2. Changelog

h3. Version 0.4 - upcoming

* Added: @return@ attribute.
* Added: Now the runtimes are added to the tag trace.
* Added: Container tag mode support.
* Changed: By default runtimes are only visible in a tag trace. Set @return@ attribute to @1@ (@return="1"@) output runtimes to the page template.

h3. Version 0.3 - 2011/08/19

* Added: a new attribute @persistent@. Disables destroying of used runtime pairs.
* Changed: Now stores the runtimes in a static variable instead of a global.

h3. Version 0.2 - 2010/06/18

* Fixed: now returns as float (compatible with pre-PHP5). "Thank you for reporting, Andreas":http://forum.textpattern.com/viewtopic.php?pid=230410#p230410.

h3. Version 0.1 - 2010/06/15

* Initial release.